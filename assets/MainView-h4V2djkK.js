import{r,o as T,a as s,c as o,b as t,d as I,t as w,F as k,n as P,e as v,w as g,g as L,f as N,h as z,u as D,i as j,j as M,k as O,l as B}from"./index-871Ie4yF.js";import{M as V,_ as R}from"./navComponent-0tjVNqH9.js";const W={class:"rounded-circle story m-1 flex-shrink-0 p-1"},F=["src"],G={__name:"storyComponent",props:{ownerItem:Object},setup(x){const y=x,c=r(null),u=function(){if(c.value.getContext){const n=c.value.getContext("2d");n.beginPath();var d=n.createLinearGradient(0,0,175,0);d.addColorStop(0,"red"),d.addColorStop(.5,"yellow"),n.arc(39,39,36,0,2*Math.PI,!0),y.ownerItem.isWatched?n.fillStyle="rgb(224,224,224)":n.fillStyle=d,n.fill(),n.beginPath(),n.arc(39,39,34,0,2*Math.PI,!0),n.fillStyle="white",n.fill()}};return T(()=>{u()}),(d,n)=>(s(),o("div",null,[t("canvas",{width:"78",height:"78",ref_key:"canvas",ref:c,class:"position-absolute"},null,512),t("div",W,[t("img",{src:x.ownerItem.storyOwnerPic,alt:""},null,8,F)])]))}},A={class:"card-header bg-body px-1 d-flex align-items-center px-2 px-md-0"},E={class:"rounded-circle user-pic"},q=["src"],H={class:"ms-2 fw-bold"},J=["id"],K={key:0,class:"carousel-indicators"},Q=["data-bs-target","data-bs-slide-to","aria-current","aria-label"],U=["src"],X=["data-bs-target"],Y=t("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1),Z=t("span",{class:"visually-hidden"},"Previous",-1),tt=[Y,Z],et=["data-bs-target"],st=t("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1),ot=t("span",{class:"visually-hidden"},"Next",-1),nt=[st,ot],at={class:"card-body px-md-0 py-1 mb-3"},lt={href:""},it=["onClick"],rt=["onClick"],ct={class:"card-text mb-2"},dt={class:"card-text d-inline fw-bold"},ut={key:0,class:"card-text ms-2 d-inline"},_t=["onClick"],ht={key:2,class:"card-text ms-2 d-inline"},mt={__name:"postComponent",setup(x){const{proxy:y}=L(),c=r([]);y.$axios({url:"/getPost",method:"post"},{userId:"123"}).then(n=>{c.value=n.data.dataList});const u=r(!1),d=function(n){u.value=!0};return(n,b)=>(s(!0),o(k,null,I(c.value,e=>(s(),o("div",{class:"card mt-3 post-card w-100 border-0",key:e.postId},[t("div",A,[t("div",E,[t("img",{src:e.postOwnerPic,alt:""},null,8,q)]),t("div",H,w(e.postOwnerName),1)]),t("div",{id:"post"+e.postId,class:"carousel slide post-pic-area position-relative"},[e.imgs.length>1?(s(),o("div",K,[(s(!0),o(k,null,I(e.imgs.length,(_,a)=>(s(),o("div",{key:a},[t("button",{class:P({active:a===0}),type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide-to":a,"aria-current":a===1,"aria-label":"Slide"+a},null,10,Q)]))),128))])):v("",!0),t("div",{class:"carousel-inner position-relative",ref_for:!0,ref:"postImg"},[(s(!0),o(k,null,I(e.imgs,(_,a)=>(s(),o("div",{class:P(["carousel-item",{active:a===0}]),key:a},[t("img",{src:_,class:"d-block w-100",alt:"..."},null,8,U)],2))),128))],512),e.imgs.length>1?(s(),o("button",{key:1,class:"carousel-control-prev",type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide":"prev"},tt,8,X)):v("",!0),e.imgs.length>1?(s(),o("button",{key:2,class:"carousel-control-next",type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide":"next"},nt,8,et)):v("",!0)],8,J),t("div",at,[t("a",lt,[e.isThumb?v("",!0):(s(),o("i",{key:0,class:"bi bi-heart icon-size text-danger",onClick:g(_=>e.isThumb=!0,["prevent"])},null,8,it)),e.isThumb?(s(),o("i",{key:1,class:"bi bi-heart-fill icon-size text-danger",onClick:g(_=>e.isThumb=!1,["prevent"])},null,8,rt)):v("",!0)]),t("p",ct,w(e.thumbNum)+"個讚",1),t("div",null,[t("span",dt,w(e.postOwnerName),1),u.value?v("",!0):(s(),o("div",ut,w(e.description.slice(0,20))+"... ",1)),u.value?v("",!0):(s(),o("a",{key:1,class:"text-decoration-none text-secondary fs-6",onClick:g(_=>d(e.postId),["prevent"]),href:"#"}," 更多 ",8,_t)),u.value?(s(),o("div",ht,w(e.description),1)):v("",!0)])])]))),128))}},vt={class:"modal-dialog modal-fullscreen-sm-down"},pt={class:"modal-content bg-transparent b-0"},yt={class:"progress",style:{height:"2px"}},bt={class:"d-flex mt-2 justify-content-between align-items-center"},ft=t("div",{class:"rounded-circle user-pic"},null,-1),gt={class:"text-light flex-grow-1 text-start ps-2"},xt={class:"rounded story-pic-area"},wt=["src"],$t=t("input",{type:"text"},null,-1),It={__name:"storyModalComponent",props:{storyOwnerId:String},setup(x,{expose:y}){const c=r(null),u=r(null),d=r(0);let n;const b=function(){d.value=0,c.value.show();const h=new Date;n=setInterval(()=>{const l=new Date,i=C.value[0].duration;l-h>=i&&_();const f=Math.round((l-h)/i*100);d.value=f},100)},e=N(()=>({width:d.value+"%"})),_=function(){n&&clearInterval(n),c.value.hide()};y({showModal:b}),T(()=>{c.value=new V(u.value)});const a=x,{proxy:m}=L(),$=r([]);m.$axios({url:"/getStories",method:"post"},{storyOwnerId:a.storyOwnerId}).then(h=>{$.value=h.data.dataList});const C=N(()=>$.value.filter(h=>h.storyOwnerId===a.storyOwnerId));return(h,l)=>(s(),o("div",{class:"modal fade custom-modal",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref_key:"storyModal",ref:u},[t("div",vt,[t("div",pt,[(s(!0),o(k,null,I(C.value,i=>(s(),o("div",{class:"modal-body text-end story-modal-body",key:i.storyId},[t("div",yt,[t("div",{class:"progress-bar",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:z(e.value)},null,4)]),t("div",bt,[ft,t("div",gt,w(i.storyOwnerName),1),t("button",{type:"button",class:"btn-close btn-close-white position-relative","data-bs-dismiss":"modal","aria-label":"Close",onClick:g(_,["prevent"])})]),t("div",xt,[t("img",{src:i.img,class:"story-content-pic",alt:""},null,8,wt),$t])]))),128))])])],512))}},kt={class:"row mx-0"},Ct={class:"col m-0 border-start min-vh-100"},Mt={class:"stories overflow-scroll w-md-75 mx-auto flex-nowrap mt-md-2 position-relative"},Ot={class:"d-flex justify-content-start align-items-center"},St=t("i",{class:"bi bi-arrow-left-circle-fill icon-size text-light"},null,-1),Nt=[St],Lt=t("i",{class:"bi bi-arrow-right-circle-fill icon-size text-light"},null,-1),Pt=[Lt],Tt={class:"d-flex flex-column justify-content-center align-items-center mb-5"},p=3,S=78,Bt={__name:"MainView",setup(x){const{proxy:y}=L(),c=r([]);y.$axios({url:"/getStoryOwner",method:"post"},{userId:"123"}).then(l=>{c.value=l.data.dataList});const u=r(null);let d=r("");const n=function(l){d.value=l.storyOwnerId,u.value.showModal()};let b=r(0),e=r(!1),_=r(!0),a=1,m=7;const $=function(l){const i=c.value.length;i-m<p&&l===-1?(b.value+=l*(i-m)*S,a+=i-m,m+=i-m):a-p<0&&l===1?(b.value+=l*(p-a)*S,m+=a-p,a+=a-p):(b.value+=l*p*S,a+=l*-p,m+=l*-p),e=r(a!==1),_=r(m<i)},C=N(()=>({transform:`translate(${b.value}px)`}));let h="";return D(),location.search&&(h=location.search.slice(6),h&&j({method:"post",url:"/igGetID/oauth/access_token",data:{client_id:"461541476203224",client_secret:"2f7242993cbd4b8c802b4b533198be85",grant_type:"authorization_code",redirect_uri:"https://chinyuting.github.io/Instagram-Imitation/",code:`${h}`}}).then(l=>{console.log(l)}).catch(l=>{console.warn(l)})),(l,i)=>(s(),o("div",kt,[M(R),t("main",Ct,[t("div",Mt,[t("div",Ot,[(s(!0),o(k,null,I(c.value,f=>(s(),B(G,{onClick:g(zt=>n(f),["prevent"]),key:f.storyOwnerId,ownerItem:f,style:z(C.value)},null,8,["onClick","ownerItem","style"]))),128))]),O(e)?(s(),o("button",{key:0,type:"button",class:"position-absolute top-50 start-0 translate-middle-y btn",onClick:i[0]||(i[0]=g(f=>$(1),["prevent"]))},Nt)):v("",!0),O(_)?(s(),o("button",{key:1,type:"button",class:"position-absolute top-50 end-0 translate-middle-y btn",onClick:i[1]||(i[1]=g(f=>$(-1),["prevent"]))},Pt)):v("",!0)]),M(It,{ref_key:"storyModal",ref:u,storyOwnerId:O(d)},null,8,["storyOwnerId"]),t("div",Tt,[M(mt)])])]))}};export{Bt as default};
