import{r as l,o as D,a as s,c as o,b as t,d as M,t as I,F as k,n as z,e as p,w as x,g as P,f as L,h as V,u as j,i as B,v as F,j as S,k as N,l as R,m as W}from"./index-41kHnI4F.js";import{M as A,_ as E}from"./navComponent-rYi4CJgj.js";const q={class:"rounded-circle story m-1 flex-shrink-0 p-1"},G=["src"],U={__name:"storyComponent",props:{ownerItem:Object},setup(w){const b=w,i=l(null),d=function(){if(i.value.getContext){const n=i.value.getContext("2d");n.beginPath();var c=n.createLinearGradient(0,0,175,0);c.addColorStop(0,"red"),c.addColorStop(.5,"yellow"),n.arc(39,39,36,0,2*Math.PI,!0),b.ownerItem.isWatched?n.fillStyle="rgb(224,224,224)":n.fillStyle=c,n.fill(),n.beginPath(),n.arc(39,39,34,0,2*Math.PI,!0),n.fillStyle="white",n.fill()}};return D(()=>{d()}),(c,n)=>(s(),o("div",null,[t("canvas",{width:"78",height:"78",ref_key:"canvas",ref:i,class:"position-absolute"},null,512),t("div",q,[t("img",{src:w.ownerItem.storyOwnerPic,alt:""},null,8,G)])]))}},H={class:"card-header bg-body px-1 d-flex align-items-center px-2 px-md-0"},J={class:"rounded-circle user-pic"},K=["src"],Q={class:"ms-2 fw-bold"},X=["id"],Y={key:0,class:"carousel-indicators"},Z=["data-bs-target","data-bs-slide-to","aria-current","aria-label"],tt=["src"],et=["data-bs-target"],st=t("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1),ot=t("span",{class:"visually-hidden"},"Previous",-1),nt=[st,ot],at=["data-bs-target"],lt=t("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1),it=t("span",{class:"visually-hidden"},"Next",-1),rt=[lt,it],ct={class:"card-body px-md-0 py-1 mb-3"},dt={href:""},ut=["onClick"],_t=["onClick"],mt={class:"card-text mb-2"},ht={class:"card-text d-inline fw-bold"},pt={key:0,class:"card-text ms-2 d-inline"},vt=["onClick"],yt={key:2,class:"card-text ms-2 d-inline"},bt={__name:"postComponent",setup(w){const{proxy:b}=P(),i=l([]);b.$axios({url:"/getPost",method:"post"},{userId:"123"}).then(n=>{i.value=n.data.dataList});const d=l(!1),c=function(n){d.value=!0};return(n,f)=>(s(!0),o(k,null,M(i.value,e=>(s(),o("div",{class:"card mt-3 post-card w-100 border-0",key:e.postId},[t("div",H,[t("div",J,[t("img",{src:e.postOwnerPic,alt:""},null,8,K)]),t("div",Q,I(e.postOwnerName),1)]),t("div",{id:"post"+e.postId,class:"carousel slide post-pic-area position-relative"},[e.imgs.length>1?(s(),o("div",Y,[(s(!0),o(k,null,M(e.imgs.length,(_,a)=>(s(),o("div",{key:a},[t("button",{class:z({active:a===0}),type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide-to":a,"aria-current":a===1,"aria-label":"Slide"+a},null,10,Z)]))),128))])):p("",!0),t("div",{class:"carousel-inner position-relative",ref_for:!0,ref:"postImg"},[(s(!0),o(k,null,M(e.imgs,(_,a)=>(s(),o("div",{class:z(["carousel-item",{active:a===0}]),key:a},[t("img",{src:_,class:"d-block w-100",alt:"..."},null,8,tt)],2))),128))],512),e.imgs.length>1?(s(),o("button",{key:1,class:"carousel-control-prev",type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide":"prev"},nt,8,et)):p("",!0),e.imgs.length>1?(s(),o("button",{key:2,class:"carousel-control-next",type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide":"next"},rt,8,at)):p("",!0)],8,X),t("div",ct,[t("a",dt,[e.isThumb?p("",!0):(s(),o("i",{key:0,class:"bi bi-heart icon-size text-danger",onClick:x(_=>e.isThumb=!0,["prevent"])},null,8,ut)),e.isThumb?(s(),o("i",{key:1,class:"bi bi-heart-fill icon-size text-danger",onClick:x(_=>e.isThumb=!1,["prevent"])},null,8,_t)):p("",!0)]),t("p",mt,I(e.thumbNum)+"個讚",1),t("div",null,[t("span",ht,I(e.postOwnerName),1),d.value?p("",!0):(s(),o("div",pt,I(e.description.slice(0,20))+"... ",1)),d.value?p("",!0):(s(),o("a",{key:1,class:"text-decoration-none text-secondary fs-6",onClick:x(_=>c(e.postId),["prevent"]),href:"#"}," 更多 ",8,vt)),d.value?(s(),o("div",yt,I(e.description),1)):p("",!0)])])]))),128))}},ft={class:"modal-dialog modal-fullscreen-sm-down"},gt={class:"modal-content bg-transparent b-0"},xt={class:"progress",style:{height:"2px"}},wt={class:"d-flex mt-2 justify-content-between align-items-center"},$t=t("div",{class:"rounded-circle user-pic"},null,-1),It={class:"text-light flex-grow-1 text-start ps-2"},kt={class:"rounded story-pic-area"},Ct=["src"],Mt=t("input",{type:"text"},null,-1),Ot={__name:"storyModalComponent",props:{storyOwnerId:String},setup(w,{expose:b}){const i=l(null),d=l(null),c=l(0);let n;const f=function(){c.value=0,i.value.show();const m=new Date;n=setInterval(()=>{const $=new Date,v=O.value[0].duration;$-m>=v&&_();const r=Math.round(($-m)/v*100);c.value=r},100)},e=L(()=>({width:c.value+"%"})),_=function(){n&&clearInterval(n),i.value.hide()};b({showModal:f}),D(()=>{i.value=new A(d.value)});const a=w,{proxy:h}=P(),C=l([]);h.$axios({url:"/getStories",method:"post"},{storyOwnerId:a.storyOwnerId}).then(m=>{C.value=m.data.dataList});const O=L(()=>C.value.filter(m=>m.storyOwnerId===a.storyOwnerId));return(m,$)=>(s(),o("div",{class:"modal fade custom-modal",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref_key:"storyModal",ref:d},[t("div",ft,[t("div",gt,[(s(!0),o(k,null,M(O.value,v=>(s(),o("div",{class:"modal-body text-end story-modal-body",key:v.storyId},[t("div",xt,[t("div",{class:"progress-bar",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:V(e.value)},null,4)]),t("div",wt,[$t,t("div",It,I(v.storyOwnerName),1),t("button",{type:"button",class:"btn-close btn-close-white position-relative","data-bs-dismiss":"modal","aria-label":"Close",onClick:x(_,["prevent"])})]),t("div",kt,[t("img",{src:v.img,class:"story-content-pic",alt:""},null,8,Ct),Mt])]))),128))])])],512))}},St={action:"https://cors-anywhere.herokuapp.com/https://api.instagram.com/oauth/access_token",id:"apiForm"},Nt=t("label",{for:"client_id"},"client_id",-1),Tt=t("input",{type:"text",id:"client_id",value:"461541476203224",name:"client_id"},null,-1),Lt=t("label",{for:"client_secret"},"client_secret",-1),Pt=R('<label for="grant_type">grant_type</label><input type="text" id="grant_type" value="authorization_code" name="grant_type"><label for="redirect_uri">redirect_uri</label><input type="text" id="redirect_uri" name="redirect_uri" value="https://chinyuting.github.io/Instagram-Imitation/"><label for="code">code</label><input type="text" id="code" name="code">',6),zt={class:"row mx-0"},Dt={class:"col m-0 border-start min-vh-100"},Vt={class:"stories overflow-scroll w-md-75 mx-auto flex-nowrap mt-md-2 position-relative"},jt={class:"d-flex justify-content-start align-items-center"},Bt=t("i",{class:"bi bi-arrow-left-circle-fill icon-size text-light"},null,-1),Ft=[Bt],Rt=t("i",{class:"bi bi-arrow-right-circle-fill icon-size text-light"},null,-1),Wt=[Rt],At={class:"d-flex flex-column justify-content-center align-items-center mb-5"},y=3,T=78,Ut={__name:"MainView",setup(w){const{proxy:b}=P(),i=l([]);b.$axios({url:"/getStoryOwner",method:"post"},{userId:"123"}).then(r=>{i.value=r.data.dataList});const d=l(null);let c=l("");const n=function(r){c.value=r.storyOwnerId,d.value.showModal()};let f=l(0),e=l(!1),_=l(!0),a=1,h=7;const C=function(r){const u=i.value.length;u-h<y&&r===-1?(f.value+=r*(u-h)*T,a+=u-h,h+=u-h):a-y<0&&r===1?(f.value+=r*(y-a)*T,h+=a-y,a+=a-y):(f.value+=r*y*T,a+=r*-y,h+=r*-y),e=l(a!==1),_=l(h<u)},O=L(()=>({transform:`translate(${f.value}px)`}));let m="";const $=l("");j();const v=function(){location.search&&(m=location.search.slice(6),m&&(document.querySelector("#code").value=m,document.getElementById("apiForm").submit()))};return(r,u)=>(s(),o(k,null,[t("form",St,[Nt,Tt,Lt,B(t("input",{type:"text",id:"client_secret",name:"client_secret","onUpdate:modelValue":u[0]||(u[0]=g=>$.value=g)},null,512),[[F,$.value]]),Pt]),t("button",{type:"btn",onClick:v},"api"),t("div",zt,[S(E),t("main",Dt,[t("div",Vt,[t("div",jt,[(s(!0),o(k,null,M(i.value,g=>(s(),W(U,{onClick:x(Et=>n(g),["prevent"]),key:g.storyOwnerId,ownerItem:g,style:V(O.value)},null,8,["onClick","ownerItem","style"]))),128))]),N(e)?(s(),o("button",{key:0,type:"button",class:"position-absolute top-50 start-0 translate-middle-y btn",onClick:u[1]||(u[1]=x(g=>C(1),["prevent"]))},Ft)):p("",!0),N(_)?(s(),o("button",{key:1,type:"button",class:"position-absolute top-50 end-0 translate-middle-y btn",onClick:u[2]||(u[2]=x(g=>C(-1),["prevent"]))},Wt)):p("",!0)]),S(Ot,{ref_key:"storyModal",ref:d,storyOwnerId:N(c)},null,8,["storyOwnerId"]),t("div",At,[S(bt)])])])],64))}};export{Ut as default};
