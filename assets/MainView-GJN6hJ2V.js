import{r as i,o as z,a as s,c as o,b as t,d as M,t as I,F as k,n as L,e as v,w,g as D,f as P,h as j,u as V,i as B,v as R,j as S,k as T,l as W}from"./index-JhqfMtpB.js";import{M as A,_ as F}from"./navComponent-mn2Y1Fzg.js";const G={class:"rounded-circle story m-1 flex-shrink-0 p-1"},E=["src"],U={__name:"storyComponent",props:{ownerItem:Object},setup($){const b=$,r=i(null),d=function(){if(r.value.getContext){const n=r.value.getContext("2d");n.beginPath();var c=n.createLinearGradient(0,0,175,0);c.addColorStop(0,"red"),c.addColorStop(.5,"yellow"),n.arc(39,39,36,0,2*Math.PI,!0),b.ownerItem.isWatched?n.fillStyle="rgb(224,224,224)":n.fillStyle=c,n.fill(),n.beginPath(),n.arc(39,39,34,0,2*Math.PI,!0),n.fillStyle="white",n.fill()}};return z(()=>{d()}),(c,n)=>(s(),o("div",null,[t("canvas",{width:"78",height:"78",ref_key:"canvas",ref:r,class:"position-absolute"},null,512),t("div",G,[t("img",{src:$.ownerItem.storyOwnerPic,alt:""},null,8,E)])]))}},q={class:"card-header bg-body px-1 d-flex align-items-center px-2 px-md-0"},H={class:"rounded-circle user-pic"},J=["src"],K={class:"ms-2 fw-bold"},Q=["id"],X={key:0,class:"carousel-indicators"},Y=["data-bs-target","data-bs-slide-to","aria-current","aria-label"],Z=["src"],tt=["data-bs-target"],et=t("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1),st=t("span",{class:"visually-hidden"},"Previous",-1),ot=[et,st],nt=["data-bs-target"],at=t("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1),lt=t("span",{class:"visually-hidden"},"Next",-1),it=[at,lt],rt={class:"card-body px-md-0 py-1 mb-3"},ct={href:""},dt=["onClick"],ut=["onClick"],_t={class:"card-text mb-2"},ht={class:"card-text d-inline fw-bold"},mt={key:0,class:"card-text ms-2 d-inline"},vt=["onClick"],pt={key:2,class:"card-text ms-2 d-inline"},yt={__name:"postComponent",setup($){const{proxy:b}=D(),r=i([]);b.$axios({url:"/getPost",method:"post"},{userId:"123"}).then(n=>{r.value=n.data.dataList});const d=i(!1),c=function(n){d.value=!0};return(n,f)=>(s(!0),o(k,null,M(r.value,e=>(s(),o("div",{class:"card mt-3 post-card w-100 border-0",key:e.postId},[t("div",q,[t("div",H,[t("img",{src:e.postOwnerPic,alt:""},null,8,J)]),t("div",K,I(e.postOwnerName),1)]),t("div",{id:"post"+e.postId,class:"carousel slide post-pic-area position-relative"},[e.imgs.length>1?(s(),o("div",X,[(s(!0),o(k,null,M(e.imgs.length,(_,a)=>(s(),o("div",{key:a},[t("button",{class:L({active:a===0}),type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide-to":a,"aria-current":a===1,"aria-label":"Slide"+a},null,10,Y)]))),128))])):v("",!0),t("div",{class:"carousel-inner position-relative",ref_for:!0,ref:"postImg"},[(s(!0),o(k,null,M(e.imgs,(_,a)=>(s(),o("div",{class:L(["carousel-item",{active:a===0}]),key:a},[t("img",{src:_,class:"d-block w-100",alt:"..."},null,8,Z)],2))),128))],512),e.imgs.length>1?(s(),o("button",{key:1,class:"carousel-control-prev",type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide":"prev"},ot,8,tt)):v("",!0),e.imgs.length>1?(s(),o("button",{key:2,class:"carousel-control-next",type:"button","data-bs-target":"#post"+e.postId,"data-bs-slide":"next"},it,8,nt)):v("",!0)],8,Q),t("div",rt,[t("a",ct,[e.isThumb?v("",!0):(s(),o("i",{key:0,class:"bi bi-heart icon-size text-danger",onClick:w(_=>e.isThumb=!0,["prevent"])},null,8,dt)),e.isThumb?(s(),o("i",{key:1,class:"bi bi-heart-fill icon-size text-danger",onClick:w(_=>e.isThumb=!1,["prevent"])},null,8,ut)):v("",!0)]),t("p",_t,I(e.thumbNum)+"個讚",1),t("div",null,[t("span",ht,I(e.postOwnerName),1),d.value?v("",!0):(s(),o("div",mt,I(e.description.slice(0,20))+"... ",1)),d.value?v("",!0):(s(),o("a",{key:1,class:"text-decoration-none text-secondary fs-6",onClick:w(_=>c(e.postId),["prevent"]),href:"#"}," 更多 ",8,vt)),d.value?(s(),o("div",pt,I(e.description),1)):v("",!0)])])]))),128))}},bt={class:"modal-dialog modal-fullscreen-sm-down"},ft={class:"modal-content bg-transparent b-0"},gt={class:"progress",style:{height:"2px"}},xt={class:"d-flex mt-2 justify-content-between align-items-center"},wt=t("div",{class:"rounded-circle user-pic"},null,-1),$t={class:"text-light flex-grow-1 text-start ps-2"},It={class:"rounded story-pic-area"},kt=["src"],Ct=t("input",{type:"text"},null,-1),Mt={__name:"storyModalComponent",props:{storyOwnerId:String},setup($,{expose:b}){const r=i(null),d=i(null),c=i(0);let n;const f=function(){c.value=0,r.value.show();const h=new Date;n=setInterval(()=>{const g=new Date,p=O.value[0].duration;g-h>=p&&_();const l=Math.round((g-h)/p*100);c.value=l},100)},e=P(()=>({width:c.value+"%"})),_=function(){n&&clearInterval(n),r.value.hide()};b({showModal:f}),z(()=>{r.value=new A(d.value)});const a=$,{proxy:m}=D(),C=i([]);m.$axios({url:"/getStories",method:"post"},{storyOwnerId:a.storyOwnerId}).then(h=>{C.value=h.data.dataList});const O=P(()=>C.value.filter(h=>h.storyOwnerId===a.storyOwnerId));return(h,g)=>(s(),o("div",{class:"modal fade custom-modal",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref_key:"storyModal",ref:d},[t("div",bt,[t("div",ft,[(s(!0),o(k,null,M(O.value,p=>(s(),o("div",{class:"modal-body text-end story-modal-body",key:p.storyId},[t("div",gt,[t("div",{class:"progress-bar",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:j(e.value)},null,4)]),t("div",xt,[wt,t("div",$t,I(p.storyOwnerName),1),t("button",{type:"button",class:"btn-close btn-close-white position-relative","data-bs-dismiss":"modal","aria-label":"Close",onClick:w(_,["prevent"])})]),t("div",It,[t("img",{src:p.img,class:"story-content-pic",alt:""},null,8,kt),Ct])]))),128))])])],512))}},Ot={class:"row mx-0"},St={class:"col m-0 border-start min-vh-100"},Tt={class:"stories overflow-scroll w-md-75 mx-auto flex-nowrap mt-md-2 position-relative"},Nt={class:"d-flex justify-content-start align-items-center"},Pt=t("i",{class:"bi bi-arrow-left-circle-fill icon-size text-light"},null,-1),Dt=[Pt],Lt=t("i",{class:"bi bi-arrow-right-circle-fill icon-size text-light"},null,-1),zt=[Lt],jt={class:"d-flex flex-column justify-content-center align-items-center mb-5"},y=3,N=78,Wt={__name:"MainView",setup($){const{proxy:b}=D(),r=i([]);b.$axios({url:"/getStoryOwner",method:"post"},{userId:"123"}).then(l=>{r.value=l.data.dataList});const d=i(null);let c=i("");const n=function(l){c.value=l.storyOwnerId,d.value.showModal()};let f=i(0),e=i(!1),_=i(!0),a=1,m=7;const C=function(l){const u=r.value.length;u-m<y&&l===-1?(f.value+=l*(u-m)*N,a+=u-m,m+=u-m):a-y<0&&l===1?(f.value+=l*(y-a)*N,m+=a-y,a+=a-y):(f.value+=l*y*N,a+=l*-y,m+=l*-y),e=i(a!==1),_=i(m<u)},O=P(()=>({transform:`translate(${f.value}px)`}));let h="";const g=i("");V();const p=function(){location.search&&(h=location.search.slice(6),h&&fetch("/igGetID/oauth/access_token",{method:"POST",body:{client_id:"461541476203224",client_secret:`${g.value}`,grant_type:"authorization_code",redirect_uri:"https://chinyuting.github.io/Instagram-Imitation/",code:`${h}`},mode:"no-cors"}).then(l=>{console.log("response",l)}).then(l=>{console.log("body",l)}))};return(l,u)=>(s(),o(k,null,[B(t("input",{type:"text","onUpdate:modelValue":u[0]||(u[0]=x=>g.value=x)},null,512),[[R,g.value]]),t("button",{type:"btn",onClick:p},"api"),t("div",Ot,[S(F),t("main",St,[t("div",Tt,[t("div",Nt,[(s(!0),o(k,null,M(r.value,x=>(s(),W(U,{onClick:w(Vt=>n(x),["prevent"]),key:x.storyOwnerId,ownerItem:x,style:j(O.value)},null,8,["onClick","ownerItem","style"]))),128))]),T(e)?(s(),o("button",{key:0,type:"button",class:"position-absolute top-50 start-0 translate-middle-y btn",onClick:u[1]||(u[1]=w(x=>C(1),["prevent"]))},Dt)):v("",!0),T(_)?(s(),o("button",{key:1,type:"button",class:"position-absolute top-50 end-0 translate-middle-y btn",onClick:u[2]||(u[2]=w(x=>C(-1),["prevent"]))},zt)):v("",!0)]),S(Mt,{ref_key:"storyModal",ref:d,storyOwnerId:T(c)},null,8,["storyOwnerId"]),t("div",jt,[S(yt)])])])],64))}};export{Wt as default};
